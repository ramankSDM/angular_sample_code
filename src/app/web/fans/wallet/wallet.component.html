<div class="user-inner-main">
  <div class="inner-head">
    <h2>{{"fan_wallet.my_wallet" | translate}}</h2>
    <div class="inner-head-rt">
      <div class="custom-search-form flex-grow-1 flex-shrink-1">
        <button (click)="addToWallet()" >Add to Wallet</button>
      </div>
    </div>
    <div class="inner-head-rt">
      <div class="custom-search-form flex-grow-1 flex-shrink-1">
        <input class="form-control pro-input-des" placeholder="{{'fan_wallet.search_placeholder' | translate}}" type="text" [(ngModel)]="searchKey">
        <span class="input-group-btn">
          <button class="btn btn-default" type="button" (click)="getAll()">
            <img src="../../../../assets/img/main-search.svg">
          </button>
        </span>
      </div>
    </div>
  </div>
  <div class="inner-body"> 
      <div class="fan-box">
          <h2>
              $ {{ fanInfo.available_wallet_points }}
              <span>{{"fan_wallet.wallet_point" | translate}}</span>
          </h2>
          <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="349.195" height="375" viewBox="0 0 349.195 375">
              <defs>
                <filter id="Path_1095" x="187.128" y="217" width="162.067" height="158" filterUnits="userSpaceOnUse">
                  <feOffset dy="3" input="SourceAlpha"/>
                  <feGaussianBlur stdDeviation="3" result="blur"/>
                  <feFlood flood-opacity="0.161"/>
                  <feComposite operator="in" in2="blur"/>
                  <feComposite in="SourceGraphic"/>
                </filter>
              </defs>
              <g id="Group_8856" data-name="Group 8856" transform="translate(-3793 -2987)">
                <g id="my-profile-ico" transform="translate(3793 2987)">
                  <path id="Path_1233" data-name="Path 1233" d="M168.683,163.3c22.434,0,41.858-8.046,57.733-23.921s23.919-35.294,23.919-57.73-8.046-41.853-23.921-57.73S191.115,0,168.683,0s-41.858,8.046-57.73,23.919-23.921,35.3-23.921,57.728,8.049,41.86,23.921,57.733,35.3,23.919,57.73,23.919ZM125,37.965c12.179-12.179,26.466-18.1,43.681-18.1s31.5,5.92,43.684,18.1,18.1,26.471,18.1,43.681-5.923,31.5-18.1,43.684-26.471,18.1-43.684,18.1-31.5-5.923-43.681-18.1-18.1-26.469-18.1-43.684,5.923-31.5,18.1-43.681Zm0,0" transform="translate(-29.407)"/>
                  <path id="Path_1234" data-name="Path 1234" d="M282.144,344.24a201.678,201.678,0,0,0-2.747-21.42,168.766,168.766,0,0,0-5.268-21.537,106.389,106.389,0,0,0-8.856-20.086,75.716,75.716,0,0,0-13.348-17.4,58.863,58.863,0,0,0-19.178-12.05,66.279,66.279,0,0,0-24.483-4.43c-3.461,0-6.807,1.42-13.271,5.628-3.978,2.594-8.631,5.594-13.824,8.913a79.214,79.214,0,0,1-17.887,7.881,69.459,69.459,0,0,1-43.756,0,78.977,78.977,0,0,1-17.874-7.878c-5.144-3.287-9.8-6.287-13.837-8.918-6.458-4.208-9.8-5.628-13.266-5.628a66.194,66.194,0,0,0-24.48,4.436A58.814,58.814,0,0,0,30.889,263.8a75.734,75.734,0,0,0-13.346,17.4A106.585,106.585,0,0,0,8.69,301.286,169.168,169.168,0,0,0,3.424,322.82,200.3,200.3,0,0,0,.677,344.248C.227,350.722,0,357.459,0,364.267c0,17.7,5.625,32.022,16.718,42.587,10.956,10.426,25.45,15.712,43.081,15.712H223.03c17.626,0,32.12-5.287,43.079-15.712,11.1-10.558,16.721-24.889,16.721-42.59,0-6.831-.233-13.568-.685-20.024Zm-29.733,48.22c-7.239,6.89-16.85,10.239-29.384,10.239H59.8c-12.536,0-22.147-3.349-29.384-10.237-7.1-6.758-10.55-15.984-10.55-28.2,0-6.352.209-12.624.628-18.645a180.667,180.667,0,0,1,2.483-19.292,149.2,149.2,0,0,1,4.632-18.987,86.771,86.771,0,0,1,7.206-16.333,56.132,56.132,0,0,1,9.81-12.857,39.048,39.048,0,0,1,12.759-7.932A45.715,45.715,0,0,1,73.029,267.2c.7.37,1.935,1.076,3.942,2.385,4.084,2.661,8.791,5.7,13.995,9.021a98.426,98.426,0,0,0,22.452,10.033,89.308,89.308,0,0,0,55.977,0,98.538,98.538,0,0,0,22.465-10.04c5.325-3.4,9.9-6.352,13.984-9.016,2.007-1.306,3.246-2.015,3.942-2.385a45.744,45.744,0,0,1,15.65,3.018,39.1,39.1,0,0,1,12.756,7.932A55.98,55.98,0,0,1,248,291.013a86.48,86.48,0,0,1,7.208,16.328,148.852,148.852,0,0,1,4.635,18.987,182.178,182.178,0,0,1,2.483,19.3v.005c.422,6,.634,12.267.636,18.637,0,12.215-3.453,21.438-10.552,28.194Zm0,0" transform="translate(0 -83.566)"/>
                </g>
                <g id="hearts" transform="translate(3733.128 2926.548)">
                  <g id="Group_8743" data-name="Group 8743" transform="translate(256 283.452)">
                    <g id="Group_8742" data-name="Group 8742">
                      <g transform="matrix(1, 0, 0, 1, -196.13, -223)" filter="url(#Path_1095)">
                        <path id="Path_1095-2" data-name="Path 1095" d="M368.51,0a39.469,39.469,0,0,0-32.477,16.953A39.566,39.566,0,0,0,264,39.562c0,17.054,7.7,35.469,22.9,54.733,11.218,14.224,26.841,29.286,46.437,44.767a4.356,4.356,0,0,0,5.4,0c19.6-15.481,35.219-30.543,46.437-44.767,15.193-19.264,22.9-37.679,22.9-54.733A39.6,39.6,0,0,0,368.51,0Zm-32.477,30.32Z" transform="translate(-67.87 223)"/>
                      </g>
                    </g>
                  </g>
                </g>
              </g>
            </svg>
                          
      </div>
      <div class="bx-shadow-body text-center p-a-15 no-record-found-outer" *ngIf="dataList && dataList.length == 0">
          <p>{{"msg_notfound" | translate}}</p>
        </div>

        <div class="bx-shadow-body" *ngIf="dataList && dataList.length != 0">
            <div class="custom-table-outer">
              <table class="table" [svData]="dataList" #sv="svDataTable" [svRowsOnPage]="rowsOnPage">
                  <thead>
                    <tr>              
                      <th class="text-center">
                        {{"fan_wallet.fan" | translate}}
                      </th>
                      <th class="text-center">
                        {{"fan_wallet.celebrity" | translate}}
                      </th>             
                      <th class="text-center">
                        {{"fan_wallet.occasion" | translate}} 
                      </th> 
                      <th class="text-center">
                        {{"fan_wallet.total_refunded_amount" | translate}}
                      </th>             
                      <th class="text-center">
                        <sv-default-sorter by="bookingDateTime" (click)="sortBy('bookingDateTime')">
                          
                            {{"fan_wallet.requested_date" | translate}}

                          
                          <i class="fa fa-sort" aria-hidden="true" *ngIf="sortKey !== 'bookingDateTime'"></i></sv-default-sorter>
                      </th> 
                      <th class="text-center"> {{"fan_wallet.booking_status" | translate}}</th>
                      <th class="text-center"> {{"fan_wallet.refund_status" | translate}}</th>
                      <th class="text-center"> {{"fan_wallet.action" | translate}} </th>
                    </tr>
                  </thead>
                  <tbody id="tableBody">
                    <tr *ngFor="let item of sv.data; let i = index">              
                      <td class="text-center">
                        <div *ngIf="selectedLang =='en'">{{ item.fan.fname_en }}</div>
                       <div *ngIf="selectedLang =='ar'">
                           {{item.fan.fname_ar ? item.fan.fname_ar:item.fan.fname_en}}
                         </div>
                      </td>
                      <td class="text-center">
                        
                        <div *ngIf="selectedLang =='en'">{{ item.celebrity.fname_en }}</div>
                       <div *ngIf="selectedLang =='ar'">
                           {{item.celebrity.fname_ar ? item.celebrity.fname_ar:item.celebrity.fname_en}}
                         </div>
                      </td>             
                      <td class="text-center">                
                        {{ item.occasion != ''?item.occasion:item.zoom_occasion != null?item.zoom_occasion:'--' }}
                      </td> 
                      <td class="text-center">
                        ${{ item.totalAmount }}
                      </td>            
                      <td class="text-center">
                        {{ item.updatedAt  | date: 'MMM d, y' }}
                      </td>  
                      <td class="text-center">
                        <span class="dot" [ngStyle]="{'background-color': item.colorCode}"></span>&nbsp; 
                        <span *ngIf="item.status == 1 || item.status == 2 || item.status == 7 || item.status == 6">{{"filter_by.in_process" | translate}}</span>
                        <span *ngIf="item.status == 3 || item.status == 4">{{"filter_by.canceled" | translate}}</span>
                        <span *ngIf="item.status == 5">{{"filter_by.completed" | translate}}</span>
                      </td>
                      <td class="text-center">
                        <span *ngIf="!(item.refundStatus) || item.refundStatus == 0">{{"dashboard.pending" | translate}}</span>
                        <span *ngIf="item.refundStatus == 1">{{"filter_by.accepted" | translate}}</span>
                        <span *ngIf="item.refundStatus == 2">{{"filter_by.rejected" | translate}}</span>                         
                      </td>
                      <td class="text-center">
                        <div class="cust-table-act-btns">
                          <span class="table-act-btn" tooltip="View Booking" (click)="openModal(viewModal,item)"><i
                            class="fas fa-eye"></i></span>                          
                        </div>
                      </td>
                    </tr>
                  </tbody>
                 
                </table>
            </div>
            <div class="custom-pagination-outer">
              <pagination [totalItems]="totalRecords" [itemsPerPage]="rowsOnPage" (pageChanged)="pageChanged($event)">
              </pagination>
            </div>
          </div>   
  </div>
</div>
<ng-template #viewModal>
  <div class="modal-outer">
    <div class="modal-header">
      <h2 class="modal-title">{{"request_popup.request_details" | translate}}</h2>
      <button type="button" class="close" aria-label="Close" (click)="closeModal()">
        <img src="../../../assets/img/modal-close.svg">
      </button>
    </div>

    <div class="modal-body text-center del-popup">
      <div class="request-content">
        <div class="req-row">
          <div class="req-item">
            <label>{{"request_popup.receipt_id" | translate}}</label>
            <span>{{viewData.receiptId}}</span>
          </div>
          <div class="req-item">
            <label> {{"request_popup.booking_time" | translate}}</label>
            <span>{{viewData.bookingDateTime | date:'yyyy-M-d h:mm a'}}</span>
          </div>
        </div>

        <div class="req-row">
          <div class="req-item">
            <label>{{"request_popup.to" | translate}} </label>             
            <span>{{viewData.celebrity.fname_en}}</span>
          </div>
          <div class="req-item">
            <label> {{"request_popup.from" | translate}}</label>             
            <span>{{viewData.fan.fname_en}}</span>
          </div>
        </div>

        <div class="req-row">
          <div class="req-item">
            <label> {{"request_popup.occasion" | translate}}</label>
            <span>{{ viewData.occasion != ''?viewData.occasion:viewData.zoom_occasion != null?viewData.zoom_occasion:'--' }}</span>
          </div>            
        </div>

        <div class="req-row">
          <div class="req-item">
            <label>{{"request_popup.refund_reason" | translate}}</label>
            <span>{{viewData.refundReason}}</span>
          </div>
          <div class="req-item">
            <label></label>
            <span></span>
          </div>
        </div> 


        <div class="req-row">
          <div class="req-item">
            <label>{{"request_popup.rating" | translate}} </label>
            <star-rating value="{{viewData.rating}}" totalstars="5" checkedcolor="red" uncheckedcolor="black"
              size="24px" readonly="true"></star-rating>
          </div>
          <div class="req-item">
            <label>{{"request_popup.comments" | translate}} </label>
            <span>{{viewData.comment}}</span>
          </div>
        </div> 

        <h5>{{"request_popup.payment_details" | translate}}</h5>
        <div class="req-row">
          <div class="req-item">
            <label>{{"request_popup.service_fee" | translate}}</label>
            <span>${{viewData.serviceFee}}</span>
          </div>
          <div class="req-item">
            <label>{{"request_popup.discount" | translate}}</label>
            <span>${{ viewData.discountAmount }}</span>
          </div>             
          <!-- <div class="req-item">
            <label>Admin Fee</label>
            <span>${{viewData.adminFee}}</span>
          </div> -->
        </div>

        <div class="req-row">
          <div class="req-item">
            <label>{{"request_popup.net_serviceFee" | translate}}</label>
            <span>${{ viewData.subTotalAmount }}</span>
          </div>
          <div class="req-item">
            <label>{{"request_popup.vat" | translate}}</label>
            <span>$0</span>
          </div>
        </div>

        <div class="req-row">            
          <div class="req-item">
            <label>{{"request_popup.total_paid_amount" | translate}}</label>
            <span>${{viewData.totalAmount}}</span>
          </div>
          <div class="req-item">
            <label></label>
            <span></span>
          </div>
        </div>
        <!-- <div class="req-row">
          <div class="req-item">
            <label> {{"request_popup.service_fee" | translate}}</label>
            <span>${{viewData.serviceFee}}</span>
          </div>
          <div class="req-item">
            <label> {{"request_popup.vat" | translate}} </label>
            <span>$0</span>
          </div>
        </div>
        <div class="req-row">
          <div class="req-item">
            <label> {{"request_popup.discount" | translate}} </label>
            <span>${{viewData.discountAmount}}</span>
          </div>
          <div class="req-item">
            <label> {{"request_popup.sub_total_fee" | translate}}</label>
            <span>${{viewData.subTotalAmount}}</span>
          </div>
        </div>

        <div class="req-row">
          <div class="req-item">
            <label>{{"request_popup.admin_fee" | translate}}</label>
            <span>${{viewData.adminFee}}</span>
          </div>
          <div class="req-item">
            <label>{{"request_popup.total_paid_amount" | translate}}</label>
            <span>${{viewData.totalAmount}}</span>
          </div>
        </div> -->
      </div>
    </div>
  </div>
</ng-template>